{
  "poam_relationship_structure": {
    "primary_connection": "NIST Security Controls",
    "secondary_connection": "Vulnerabilities (as evidence)",
    "explanation": "POAMs are created when a security control is not fully implemented or has deficiencies. Vulnerabilities serve as evidence of control failures."
  },
  "connection_hierarchy": [
    {
      "level": 1,
      "entity": "NIST Security Control",
      "example": "SI-2 (Flaw Remediation)",
      "description": "The control requirement that must be implemented"
    },
    {
      "level": 2,
      "entity": "Control Finding",
      "example": "FIND-SI2-001: Critical patches not applied within required timeframe",
      "description": "Assessment finding indicating control deficiency"
    },
    {
      "level": 3,
      "entity": "POAM",
      "example": "POAM-2024-001: Remediate Apache vulnerabilities",
      "description": "Remediation plan to address the control deficiency"
    },
    {
      "level": 4,
      "entity": "Supporting Vulnerabilities",
      "example": "CVE-2021-44790, CVE-2021-44224 on web01.enterprise.local",
      "description": "Specific vulnerabilities that provide evidence of the control failure"
    }
  ],
  "real_world_example": {
    "control_id": "SI-2",
    "control_title": "Flaw Remediation",
    "control_requirement": "The organization identifies, reports, and corrects information system flaws",
    "assessment_finding": {
      "finding_id": "FIND-SI2-001",
      "description": "Critical Apache HTTP Server vulnerabilities not patched within 30-day requirement",
      "evidence_vulnerabilities": [
        {
          "cve": "CVE-2021-44790",
          "plugin_id": 144228,
          "asset": "web01.enterprise.local",
          "discovered_date": "2024-06-13",
          "days_open": 45
        },
        {
          "cve": "CVE-2021-44224", 
          "plugin_id": 144228,
          "asset": "test-web01.enterprise.local",
          "discovered_date": "2024-06-13",
          "days_open": 45
        }
      ]
    },
    "generated_poam": {
      "poam_id": "POAM-2024-001",
      "weakness_description": "Apache HTTP Server Critical Vulnerabilities - Remote Code Execution",
      "source": "Tenable Vulnerability Scan Finding FIND-SI2-001",
      "security_control": "SI-2",
      "root_cause": "Patch management process delays for critical web infrastructure",
      "corrective_action": "Apply vendor security patches and improve patch testing procedures",
      "affected_assets": [
        "12345678-1234-1234-1234-123456789002",
        "12345678-1234-1234-1234-123456789014"
      ],
      "supporting_vulnerabilities": [
        "CVE-2021-44790",
        "CVE-2021-44224"
      ]
    }
  },
  "multiple_vulnerabilities_single_poam": {
    "scenario": "Multiple vulnerabilities can support a single POAM when they indicate the same control deficiency",
    "example": {
      "poam_id": "POAM-2024-004",
      "control": "SI-2 (Flaw Remediation)",
      "weakness": "Red Hat Enterprise Linux Kernel Use-After-Free Vulnerabilities",
      "supporting_vulnerabilities": [
        {
          "asset": "db01.enterprise.local",
          "cves": ["CVE-2022-1015", "CVE-2022-1016"],
          "plugin_id": 147462
        },
        {
          "asset": "finance01.enterprise.local", 
          "cves": ["CVE-2023-1513", "CVE-2023-2002"],
          "plugin_id": 147462
        }
      ],
      "rationale": "Both vulnerabilities indicate systemic failure in kernel patch management across RHEL systems"
    }
  },
  "single_vulnerability_multiple_controls": {
    "scenario": "A single vulnerability can impact multiple controls, creating multiple POAMs",
    "example": {
      "vulnerability": {
        "cve": "CVE-2017-0144",
        "description": "MS17-010 EternalBlue SMB vulnerability",
        "asset": "dc01.enterprise.local"
      },
      "impacted_controls_and_poams": [
        {
          "control": "SI-2 (Flaw Remediation)",
          "poam": "POAM-2024-002",
          "rationale": "Critical patch not applied within required timeframe"
        },
        {
          "control": "AC-2 (Account Management)",
          "poam": "POAM-2024-002", 
          "rationale": "SMB vulnerability enables unauthorized account access"
        },
        {
          "control": "SC-7 (Boundary Protection)",
          "poam": "POAM-2024-011",
          "rationale": "Domain controller compromise bypasses network boundary controls"
        }
      ]
    }
  },
  "data_flow_summary": {
    "step_1": "Tenable discovers vulnerabilities on assets",
    "step_2": "Vulnerabilities are mapped to affected NIST controls",
    "step_3": "Control assessment identifies implementation gaps",
    "step_4": "Control findings are documented with vulnerability evidence",
    "step_5": "POAMs are created to remediate control deficiencies",
    "step_6": "Vulnerabilities are tracked as supporting evidence for POAMs"
  },
  "database_relationships": {
    "controls_table": {
      "primary_key": "control_id",
      "links_to": "poams_table.security_control"
    },
    "poams_table": {
      "primary_key": "poam_id", 
      "foreign_keys": [
        "security_control -> controls_table.control_id",
        "system_id -> systems_table.system_id"
      ]
    },
    "vulnerabilities_table": {
      "primary_key": "vulnerability_id",
      "links_to": "poam_vulnerabilities_table.vulnerability_id"
    },
    "poam_vulnerabilities_table": {
      "description": "Junction table linking POAMs to supporting vulnerabilities",
      "foreign_keys": [
        "poam_id -> poams_table.poam_id",
        "vulnerability_id -> vulnerabilities_table.vulnerability_id"
      ]
    }
  },
  "practical_workflow": {
    "vulnerability_discovered": {
      "action": "Tenable scan identifies CVE-2021-44790 on web server",
      "immediate_effect": "Vulnerability record created in database"
    },
    "control_assessment": {
      "action": "Vulnerability mapped to SI-2 control failure",
      "immediate_effect": "Control finding generated with vulnerability as evidence"
    },
    "poam_creation": {
      "action": "POAM created to address SI-2 control deficiency", 
      "immediate_effect": "Remediation plan established with vulnerability references"
    },
    "remediation_tracking": {
      "action": "Patches applied to resolve vulnerability",
      "immediate_effect": "Vulnerability marked resolved, POAM milestone updated"
    },
    "control_closure": {
      "action": "All supporting vulnerabilities resolved",
      "immediate_effect": "Control finding closed, POAM completed"
    }
  }
}